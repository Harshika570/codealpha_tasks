<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Basic Calculator</title>
<style>
  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    background: #1e1e2f;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    padding: 10px;
  }

  .calculator {
    background: #2b2b44;
    width: 100%;
    max-width: 350px;
    border-radius: 16px;
    box-shadow: 0 0 15px #0009;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    height: 600px;
    max-height: 100vh;
  }

  .display {
    background: #24243b;
    color: #f0f0f0;
    font-size: 2.5rem;
    padding: 20px;
    text-align: right;
    user-select: none;
    word-wrap: break-word;
    min-height: 80px;
    line-height: 1.2;
  }

  .buttons {
    flex-grow: 1;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    padding: 20px;
    background: #2b2b44;
  }

  button {
    font-size: 1.6rem;
    border: none;
    border-radius: 12px;
    background: #46466f;
    color: #f0f0f0;
    box-shadow: 0 4px #313153;
    cursor: pointer;
    transition: background 0.25s ease;
    user-select: none;
  }
  button:active {
    box-shadow: none;
    transform: translateY(2px);
  }

  button.operator {
    background: #ff9500;
    color: #fff;
    box-shadow: 0 4px #cc7a00;
  }
  button.operator:active {
    background: #cc7a00;
  }

  button.equal {
    background: #1c8adb;
    color: #fff;
    grid-column: span 2;
    box-shadow: 0 4px #1368b7;
  }
  button.equal:active {
    background: #1368b7;
  }

  button.clear {
    background: #ff3b30;
    color: #fff;
    box-shadow: 0 4px #b32c27;
  }
  button.clear:active {
    background: #b32c27;
  }

  /* Responsive text size for smaller screens */
  @media (max-width: 380px) {
    .display {
      font-size: 2rem;
      padding: 15px;
      min-height: 70px;
    }
    button {
      font-size: 1.3rem;
      padding: 12px 0;
    }
  }
</style>
</head>
<body>
  <div class="calculator" role="application" aria-label="Calculator">
    <div id="display" class="display" aria-live="assertive" aria-atomic="true">0</div>
    <div class="buttons">
      <button class="clear" id="clear" aria-label="Clear">C</button>
      <button class="operator" data-operator="/" aria-label="Divide">÷</button>
      <button class="operator" data-operator="*" aria-label="Multiply">×</button>
      <button class="operator" data-operator="-" aria-label="Subtract">−</button>

      <button data-number="7" aria-label="7">7</button>
      <button data-number="8" aria-label="8">8</button>
      <button data-number="9" aria-label="9">9</button>
      <button class="operator" data-operator="+" aria-label="Add">+</button>

      <button data-number="4" aria-label="4">4</button>
      <button data-number="5" aria-label="5">5</button>
      <button data-number="6" aria-label="6">6</button>
      <button data-number="0" style="visibility:hidden">0 hidden</button>

      <button data-number="1" aria-label="1">1</button>
      <button data-number="2" aria-label="2">2</button>
      <button data-number="3" aria-label="3">3</button>
      <button class="equal" id="equal" aria-label="Equals">=</button>

      <button data-number="0" aria-label="0">0</button>
      <button data-number="." aria-label="Decimal point">.</button>
    </div>
  </div>

<script>
(function(){
  const display = document.getElementById('display');
  const buttons = document.querySelectorAll('button');
  let currentInput = '';
  let lastResult = null;
  let lastOperator = null;
  let resetNext = false;

  function updateDisplay(text) {
    display.textContent = text;
  }

  function appendNumber(num) {
    if(resetNext) {
      currentInput = num === '.' ? '0.' : num;
      resetNext = false;
    } else {
      if(num === '.' && currentInput.includes('.')) return;
      if(currentInput === '0' && num !== '.') {
        currentInput = num;
      } else {
        currentInput += num;
      }
    }
    updateDisplay(currentInput);
  }

  function clearAll() {
    currentInput = '';
    lastResult = null;
    lastOperator = null;
    resetNext = false;
    updateDisplay('0');
  }

  function calculate(a, b, operator) {
    a = parseFloat(a);
    b = parseFloat(b);
    if(isNaN(a) || isNaN(b)) return 'Error';
    let result;
    switch(operator) {
      case '+': result = a + b; break;
      case '-': result = a - b; break;
      case '*': result = a * b; break;
      case '/': 
        if(b === 0) return 'Error';
        result = a / b; 
        break;
      default: return 'Error';
    }
    return result.toString();
  }

  function handleOperator(op) {
    if(lastOperator && !resetNext) {
      lastResult = calculate(lastResult, currentInput || lastResult, lastOperator);
      if(lastResult === 'Error') {
        updateDisplay('Error');
        resetNext = true;
        return;
      }
      updateDisplay(lastResult);
    } else if (!resetNext) {
      lastResult = currentInput || lastResult || '0';
    }
    lastOperator = op;
    resetNext = true;
  }

  function handleEqual() {
    if(lastOperator && !resetNext) {
      lastResult = calculate(lastResult, currentInput, lastOperator);
      if(lastResult === 'Error') {
        updateDisplay('Error');
      } else {
        updateDisplay(+parseFloat(lastResult).toFixed(10)); // Trim float precision
      }
      lastOperator = null;
      resetNext = true;
      currentInput = lastResult;
    }
  }

  buttons.forEach(button => {
    // Number buttons
    if(button.dataset.number !== undefined) {
      button.addEventListener('click', () => {
        appendNumber(button.dataset.number);
      });
      return;
    }
    // Clear button
    if(button.id === 'clear') {
      button.addEventListener('click', () => {
        clearAll();
      });
      return;
    }
    // Operator buttons
    if(button.classList.contains('operator')) {
      button.addEventListener('click', () => {
        handleOperator(button.dataset.operator);
      });
      return;
    }
    // Equal button
    if(button.id === 'equal') {
      button.addEventListener('click', () => {
        handleEqual();
      });
      return;
    }
  });

  // Initialize display
  clearAll();

  // Keyboard support
  window.addEventListener('keydown', e => {
    if((e.key >= '0' && e.key <= '9') || e.key === '.') {
      e.preventDefault();
      appendNumber(e.key);
    } else if(['+', '-', '*', '/'].includes(e.key)) {
      e.preventDefault();
      handleOperator(e.key);
    } else if(e.key === 'Enter' || e.key === '=') {
      e.preventDefault();
      handleEqual();
    } else if(e.key === 'Backspace') {
      e.preventDefault();
      if(!resetNext && currentInput.length > 0) {
        currentInput = currentInput.slice(0, -1);
        if(currentInput === '') currentInput = '0';
        updateDisplay(currentInput);
      }
    } else if(e.key.toLowerCase() === 'c') {
      e.preventDefault();
      clearAll();
    }
  });
})();
</script>
</body>
</html>

